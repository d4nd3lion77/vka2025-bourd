!function(o){function e(e){for(var a,t,l=e[0],d=e[1],n=e[2],s=0,i=[];s<l.length;s++)t=l[s],Object.prototype.hasOwnProperty.call(c,t)&&c[t]&&i.push(c[t][0]),c[t]=0;for(a in d)Object.prototype.hasOwnProperty.call(d,a)&&(o[a]=d[a]);for(f&&f(e);i.length;)i.shift()();return u.push.apply(u,n||[]),r()}function r(){for(var e,a=0;a<u.length;a++){for(var t=u[a],l=!0,d=1;d<t.length;d++){var n=t[d];0!==c[n]&&(l=!1)}l&&(u.splice(a--,1),e=s(s.s=t[0]))}return e}var t={},c={3:0},u=[];function s(e){if(t[e])return t[e].exports;var a=t[e]={i:e,l:!1,exports:{}};return o[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=o,s.c=t,s.d=function(e,a,t){s.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:t})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(a,e){if(1&e&&(a=s(a)),8&e)return a;if(4&e&&"object"==typeof a&&a&&a.__esModule)return a;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:a}),2&e&&"string"!=typeof a)for(var l in a)s.d(t,l,function(e){return a[e]}.bind(null,l));return t},s.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(a,"a",a),a},s.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},s.p="/themes/vkactf2021/static/js";var a=(l=window.webpackJsonp=window.webpackJsonp||[]).push.bind(l);l.push=e;for(var l=l.slice(),d=0;d<l.length;d++)e(l[d]);var f=a;u.push(["./CTFd/themes/vkactf2021/assets/js/pages/challenges.js",0,1]),r()}({"./CTFd/themes/vkactf2021/assets/js/pages/challenges.js":function(e,a,t){t("./CTFd/themes/vkactf2021/assets/js/pages/main.js"),t("./node_modules/bootstrap/js/dist/tab.js");var l=t("./CTFd/themes/vkactf2021/assets/js/ezq.js"),o=t("./CTFd/themes/vkactf2021/assets/js/utils.js"),r=c(t("./node_modules/dayjs/dayjs.min.js")),d=c(t("./node_modules/dayjs/plugin/relativeTime.js")),x=c(t("./node_modules/jquery/dist/jquery.js")),n=c(t("./CTFd/themes/vkactf2021/assets/js/CTFd.js")),s=c(t("./CTFd/themes/vkactf2021/assets/js/config.js")),i=c(t("./node_modules/highlight.js/lib/index.js"));function c(e){return e&&e.__esModule?e:{default:e}}t("./node_modules/dayjs/locale/ru.js");var u=t("./node_modules/dayjs/plugin/utc.js"),t=t("./node_modules/dayjs/plugin/timezone.js");r.default.extend(u),r.default.extend(t),r.default.tz.setDefault("Europe/Moscow"),r.default.extend(d.default),r.default.locale("ru");var f={teams:function(e){return n.default.api.get_team_solves({teamId:e})},users:function(e){return n.default.api.get_user_solves({userId:e})}};n.default._internal.challenge={};var O=[],p=[],T=function(a){var e=x.default.grep(O,function(e){return e.id==a})[0];"hidden"!==e.type?h(e):(0,l.ezAlert)({title:"Задание скрыто!",body:"Вы еще не разблокировали эту задачу!",button:"Понятно!"})},h=function(l){return Promise.all([n.default.api.get_challenge({challengeId:l.id}),x.default.getScript(s.default.urlRoot+l.script),x.default.get(s.default.urlRoot+l.template)]).then(function(e){var a=n.default._internal.challenge;(0,x.default)("#challenge-window").empty(),a.data=e[0].data,a.preRender(),(0,x.default)("#challenge-window").append(e[0].data.view),(0,x.default)("#challenge-window #challenge-input").addClass("form-control user-input-f"),(0,x.default)("#challenge-window #challenge-submit").addClass("btn button-f float-right w-100 p-0");var t=(0,x.default)("#challenge-window").find(".modal-dialog");if(window.init.theme_settings&&window.init.theme_settings.challenge_window_size)switch(window.init.theme_settings.challenge_window_size){case"sm":t.addClass("modal-sm");break;case"lg":t.addClass("modal-lg");break;case"xl":t.addClass("modal-xl")}(0,x.default)(".challenge-solves").click(function(e){I((0,x.default)("#challenge-id").val())}),(0,x.default)(".nav-tabs a").click(function(e){e.preventDefault(),(0,x.default)(this).tab("show")}),(0,x.default)("#challenge-window").on("hide.bs.modal",function(e){(0,x.default)("#challenge-input").removeClass("wrong"),(0,x.default)("#challenge-input").removeClass("correct"),(0,x.default)("#incorrect-key").slideUp(),(0,x.default)("#correct-key").slideUp(),(0,x.default)("#already-solved").slideUp(),(0,x.default)("#too-fast").slideUp()}),(0,x.default)(".load-hint").on("click",function(e){y((0,x.default)(this).data("hint-id"))}),(0,x.default)("#challenge-submit").click(function(e){e.preventDefault(),(0,x.default)("#challenge-submit").addClass("disabled-button"),(0,x.default)("#challenge-submit").prop("disabled",!0),n.default._internal.challenge.submit().then(g).then(v).then(m)}),(0,x.default)("#challenge-input").keyup(function(e){13==e.keyCode&&(0,x.default)("#challenge-submit").click()}),a.postRender(),(0,x.default)("#challenge-window").find("pre code").each(function(e){i.default.highlightBlock(this)}),window.location.replace(window.location.href.split("#")[0]+"#".concat(l.name,"-").concat(l.id)),(0,x.default)("#challenge-window").modal()})};function g(e){var a=e.data,t=(0,x.default)("#result-message"),e=(0,x.default)("#result-notification"),l=(0,x.default)("#challenge-input");e.removeClass(),t.text(a.message),"authentication_required"!==a.status?("incorrect"===a.status?(e.addClass("alert alert-danger alert-dismissable text-center"),e.slideDown(),l.removeClass("correct"),l.addClass("wrong"),setTimeout(function(){l.removeClass("wrong")},3e3)):"correct"===a.status?(e.addClass("alert alert-success alert-dismissable text-center"),e.slideDown(),a.postdescription&&(0,x.default)(".challenge-desc").append('<hr style="background-color: #511592;">'+'<span class="challenge-desc text-white-f"><p>{0}</p></span>'.format(a.postdescription)),(0,x.default)(".challenge-solves").text().trim()&&(0,x.default)(".challenge-solves").text("Решений "+(parseInt((0,x.default)(".challenge-solves").text().split(" ")[1])+1)),l.val(""),l.removeClass("wrong"),l.addClass("correct")):"already_solved"===a.status?(e.addClass("alert alert-info alert-dismissable text-center"),e.slideDown(),l.addClass("correct")):"paused"===a.status?(e.addClass("alert alert-warning alert-dismissable text-center"),e.slideDown()):"ratelimited"===a.status&&(e.addClass("alert alert-warning alert-dismissable text-center"),e.slideDown(),l.addClass("too-fast"),setTimeout(function(){l.removeClass("too-fast")},3e3)),setTimeout(function(){(0,x.default)(".alert").slideUp(),(0,x.default)("#challenge-submit").removeClass("disabled-button"),(0,x.default)("#challenge-submit").prop("disabled",!1)},3e3)):window.location=n.default.config.urlRoot+"/login?next="+n.default.config.urlRoot+window.location.pathname+window.location.hash}function m(){return f[n.default.config.userMode]("me").then(function(e){for(var a=e.data,t=a.length-1;0<=t;t--){var l=(0,x.default)('button[value="'+a[t].challenge_id+'"]'),d=(0,x.default)(".diag-"+a[t].challenge_id);l.addClass("solved-challenge"),d.addClass("diag-open")}})}function I(e){return n.default.api.get_challenge_solves({challengeId:e}).then(function(e){var a=e.data;(0,x.default)(".challenge-solves").text("Решений "+parseInt(a.length));var t=(0,x.default)("#challenge-solves-names");t.empty();for(var l=0;l<a.length;l++){var d=a[l].account_id,n=a[l].name,s=r.default.tz(a[l].date).fromNow(),i=a[l].account_url;t.append('<tr><td><a class="teamname-bold-f" href="{0}">{2}</td><td class="text-white-f">{3}</td></tr>'.format(i,d,(0,o.htmlEntities)(n),s))}})}function z(e){for(var a=e.name.replace(/ /g,"-").hashCode(),t=(0,x.default)("<div id='{0}' class='col-md-4 d-inline-block'></div>".format(a)),l=-1==p.indexOf(e.id)?(0,x.default)("<button class='btn challenge-btn-f w-100 text-truncate pt-3 pb-3 mb-2 {0} px-0' value='{1}'></button>".format("hidden"===e.type?"inactive":"",e.id)):(0,x.default)("<button class='btn btn-dark challenge-button solved-challenge w-100 text-truncate pt-3 pb-3 mb-2 px-0' value='{0}'><i class='fas fa-check corner-button-check'></i></button>".format(e.id)),d=(0,x.default)("<p>{0}</p>".format(e.name)),a=(0,x.default)("<span>{0}</span>".format(e.value)),n=0;n<e.tags.length;n++){var s="tag-"+e.tags[n].value.replace(/ /g,"-");t.addClass(s)}return l.append(d),l.append(a),t.append(l),t}function v(){return n.default.api.confrontation().then(function(e){(0,x.default)(".pg-bar-red-f").css("width",e.data.ussr+"%"),(0,x.default)(".pg-bar-red-f").text(e.data.ussr+"%"),(0,x.default)(".pg-bar-blue-f").css("width",e.data.spacex+"%"),(0,x.default)(".pg-bar-blue-f").text(e.data.spacex+"%"),(0,x.default)(".pg-bar-f").removeClass("d-none")}),n.default.api.get_challenge_list().then(function(e){var a="",t="",l=(0,x.default)("#challenges-board");O=e.data,themes=["other","spacex","ussr"],l.empty();for(var d=themes.length-1;0<=d;d--){categories={other:[],spacex:[],ussr:[]};for(var n=themes[d],s=n.replace(/ /g,"-").hashCode(),i=(0,x.default)('<div id="{0}-theme" class="notif-box">'.format(s)+'<div class="theme-header label-f col-md-12 my-5 text-center"></div></div>'),o=O.length-1;0<=o;o--){if(O[o].topic!=n){if(-1!=x.default.inArray(O[o].topic,Object.keys(categories)))continue;if("other"!==n)continue}var r,c,t=n;O[o].solves=0,-1==x.default.inArray(O[o].category,categories[t])&&"quest"!=O[o].topic&&(c=O[o].category,categories[t].push(c),r=c.replace(/ /g,"-").hashCode(),c=(0,x.default)('<div id="{0}-row">'.format(r)+'<h4 class="category-header label-f ml-5 mb-3">'+c+'</h4><div class="category-challenges col-md-12"><div class="challenges-row col-md-12 mb-5"></div></div></div>'),i.append(c))}a="ussr"===t?"CCCP 2.0":"spacex"===t?"Космос Х":"Другие",i.find(".theme-header").append((0,x.default)("<h3>"+a+"</h3>")),0!=categories[t].length&&l.append(i)}l.append((0,x.default)('<div class="notif-box"><div class="theme-header label-f col-md-12 my-5 text-center"><h3>Тайна девятой планеты</h3></div><div id="quest-challs" class="category-challenges col-md-12"></div></div>'));for(var u=0;u<=O.length-1;u++){var f=O[u],p="",p=(-1!=x.default.inArray(f.topic,Object.keys(categories))?f.topic.replace(/ /g,"-"):"other").hashCode(),h=f.category.replace(/ /g,"-").hashCode(),f=z(f);(0,x.default)("#"+p+"-theme > #"+h+"-row").find(".category-challenges > .challenges-row").append(f)}for(var g=0;g<=5;g++){for(var m,v,b,w,y,k,C=(0,x.default)('<div class="challenges-row col-md-12 mb-medium-f d-sm-flex justify-content-sm-center"></div>'),_=0,j=0;j<=O.length-1;j++)if("quest"==O[j].topic){if(0==g){"Начало приключений"==O[j].name&&(w=z(m=O[j])),C.append('<div class="diag diag-{0} diag-1-2 d-none d-sm-block"></div>'.format(m.id)),C.append(w),C.append('<div class="diag diag-{0} diag-1-3 d-none d-sm-block"></div>'.format(m.id));break}if(1==g){if("Судьбоносные записки"==O[j].name?(_+=1,w=z(m=O[j])):"Отцовская консоль"==O[j].name&&(_+=1,y=z(v=O[j])),2==_){C.append('<div class="diag diag-{0} diag-1-1 d-none d-sm-block"></div>'.format(m.id)+'<div class="diag diag-{0} diag-1-2 d-none d-sm-block"></div>'.format(m.id)),C.append(w),C.append(y),C.append('<div class="diag diag-{0} diag-1-3 d-none d-sm-block"></div>'.format(v.id)+'<div class="diag diag-{0} diag-1-4 d-none d-sm-block"></div>'.format(v.id));break}}else if(2==g){if("Космический музей"==O[j].name?(_+=1,w=z(m=O[j])):"Пип-Бой"==O[j].name?(_+=1,y=z(v=O[j])):"Лотерея"==O[j].name&&(_+=1,k=z(b=O[j])),3==_){C.append('<div class="diag diag-{0} diag-2-1 d-none d-sm-block"></div>'.format(m.id)),C.append(w),C.append('<div class="diag diag-{0} diag-2-2 d-none d-sm-block"></div>'.format(v.id)),C.append(y),C.append(k),C.append('<div class="diag diag-{0} diag-2-3 d-none d-sm-block"></div>'.format(b.id));break}}else if(3==g){if("Тайная передача"==O[j].name?(_+=1,w=z(m=O[j])):"Дино"==O[j].name&&(_+=1,y=z(v=O[j])),2==_){C.append('<div class="diag diag-{0} diag-3-1 d-none d-sm-block"></div>'.format(m.id)),C.append(w),C.append(y),C.append('<div class="diag diag-{0} diag-3-2 d-none d-sm-block"></div>'.format(v.id));break}}else if(4==g){if("Терминальный доступ"==O[j].name?(_+=1,w=z(m=O[j])):"Управление полётами"==O[j].name&&(_+=1,y=z(v=O[j])),2==_){C.append('<div class="diag diag-{0} diag-4-1 d-none d-sm-block"></div>'.format(m.id)),C.append(w),C.append(y),C.append('<div class="diag diag-{0} diag-4-2 d-none d-sm-block"></div>'.format(v.id));break}}else if("Старая база"==O[j].name){chalinfo=O[j],chalwrap=z(chalinfo),C.append(chalwrap);break}}(0,x.default)("#quest-challs").append(C)}(0,x.default)(".challenge-btn-f").click(function(e){T(this.value),I(this.value)})})}function b(){return(0==n.default.user.id?Promise.resolve():f[n.default.config.userMode]("me").then(function(e){for(var a=e.data,t=a.length-1;0<=t;t--){var l=a[t].challenge_id;a.push(l)}})).then(v).then(m)}(0,x.default)(function(){b().then(function(){var e,a,t;0<window.location.hash.length&&(e=decodeURIComponent(window.location.hash.substring(1)),a=e.lastIndexOf("-"),t=[e.slice(0,a),e.slice(a+1)][1],a=x.default.grep(O,function(e){return e.id==t})[0],h(a))}),(0,x.default)("#challenge-input").keyup(function(e){13==e.keyCode&&(0,x.default)("#challenge-submit").click()}),(0,x.default)(".nav-tabs a").click(function(e){e.preventDefault(),(0,x.default)(this).tab("show")}),(0,x.default)("#challenge-window").on("hidden.bs.modal",function(e){(0,x.default)(".nav-tabs a:first").tab("show"),history.replaceState("",window.document.title,window.location.pathname)}),(0,x.default)(".challenge-solves").click(function(e){I((0,x.default)("#challenge-id").val())}),(0,x.default)("#challenge-window").on("hide.bs.modal",function(e){(0,x.default)("#challenge-input").removeClass("wrong"),(0,x.default)("#challenge-input").removeClass("correct"),(0,x.default)("#incorrect-key").slideUp(),(0,x.default)("#correct-key").slideUp(),(0,x.default)("#already-solved").slideUp(),(0,x.default)("#too-fast").slideUp()})}),setInterval(b,3e5);function w(e){(0,l.ezAlert)({title:"Подсказка",body:e.html,button:"Принял!"})}var y=function(t){n.default.api.get_hint({hintId:t}).then(function(e){var a;e.data.content?w(e.data):(a=t,(0,l.ezQuery)({title:"Разблокировать подсказку?",body:"Вы уверены, что хотите открыть эту подсказку?",success:function(){n.default.api.post_unlock_list({},{target:a,type:"hints"}).then(function(e){e.success?n.default.api.get_hint({hintId:a}).then(function(e){w(e.data)}):(0,l.ezAlert)({title:"Ошибка",body:e.errors.score,button:"Принял!"})})}}))})}}});